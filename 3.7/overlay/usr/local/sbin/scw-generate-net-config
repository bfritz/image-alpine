#!/usr/bin/env ash

for iface in $(ls /sys/class/net); do
	# Only configure physical interfaces
	if readlink /sys/class/net/$iface | grep -s -v 'virtual'; then
		if [ $(grep -c "$iface" /etc/network/interfaces) -eq 0 ]; then
			echo "# Configuration for $iface generated by $(basename $0)
auto $iface
iface $iface inet dhcp
iface $iface inet6 manual
	pre-up echo 1 > /proc/sys/net/ipv6/conf/$iface/accept_ra
" >> /etc/network/interfaces
		fi
	fi
done
